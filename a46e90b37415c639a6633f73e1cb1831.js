ace.define("ace/ext/beautify",["require","exports","module","ace/token_iterator"],function(O,p,F){"use strict";var _=O("../token_iterator").TokenIterator;function f(c,g){return c.type.lastIndexOf(g+".xml")>-1}p.singletonTags=["area","base","br","col","command","embed","hr","html","img","input","keygen","link","meta","param","source","track","wbr"],p.blockTags=["article","aside","blockquote","body","div","dl","fieldset","footer","form","head","header","html","nav","ol","p","script","section","style","table","tbody","tfoot","thead","ul"],p.beautify=function(c){for(var g=new _(c,0,0),t=g.getCurrentToken(),j=c.getTabString(),q=p.singletonTags,D=p.blockTags,s,m=!1,l=!1,d=!1,a="",e="",T="",r=0,x=0,L=0,u=0,v=0,b=0,S=0,R,B=0,i=0,A=[],K=!1,n,$=!1,C=!1,I=!1,h=!1,N={0:0},y=[],k=function(){s&&s.value&&s.type!=="string.regexp"&&(s.value=s.value.replace(/^\s*/,""))},w=function(){a=a.replace(/ +$/,"")},o=function(){a=a.trimRight(),m=!1};t!==null;){if(B=g.getCurrentTokenRow(),A=g.$rowTokens,s=g.stepForward(),typeof t!="undefined"){if(e=t.value,v=0,I=T==="style"||c.$modeId==="ace/mode/css",f(t,"tag-open")?(C=!0,s&&(h=D.indexOf(s.value)!==-1),e==="</"&&(h&&!m&&i<1&&i++,I&&(i=1),v=1,h=!1)):f(t,"tag-close")?C=!1:f(t,"comment.start")?h=!0:f(t,"comment.end")&&(h=!1),!C&&!i&&t.type==="paren.rparen"&&t.value.substr(0,1)==="}"&&i++,B!==R&&(i=B,R&&(i-=R)),i){for(o();i>0;i--)a+=`
`;m=!0,!f(t,"comment")&&!t.type.match(/^(comment|string)$/)&&(e=e.trimLeft())}if(e){if(t.type==="keyword"&&e.match(/^(if|else|elseif|for|foreach|while|switch)$/)?(y[r]=e,k(),d=!0,e.match(/^(else|elseif)$/)&&a.match(/\}[\s]*$/)&&(o(),l=!0)):t.type==="paren.lparen"?(k(),e.substr(-1)==="{"&&(d=!0,$=!1,C||(i=1)),e.substr(0,1)==="{"&&(l=!0,a.substr(-1)!=="["&&a.trimRight().substr(-1)==="["?(o(),l=!1):a.trimRight().substr(-1)===")"?o():w())):t.type==="paren.rparen"?(v=1,e.substr(0,1)==="}"&&(y[r-1]==="case"&&v++,a.trimRight().substr(-1)==="{"?o():(l=!0,I&&(i+=2))),e.substr(0,1)==="]"&&a.substr(-1)!=="}"&&a.trimRight().substr(-1)==="}"&&(l=!1,u++,o()),e.substr(0,1)===")"&&a.substr(-1)!=="("&&a.trimRight().substr(-1)==="("&&(l=!1,u++,o()),w()):(t.type==="keyword.operator"||t.type==="keyword")&&e.match(/^(=|==|===|!=|!==|&&|\|\||and|or|xor|\+=|.=|>|>=|<|<=|=>)$/)?(o(),k(),l=!0,d=!0):t.type==="punctuation.operator"&&e===";"?(o(),k(),d=!0,I&&i++):t.type==="punctuation.operator"&&e.match(/^(:|,)$/)?(o(),k(),e.match(/^(,)$/)&&S>0&&b===0?i++:(d=!0,m=!1)):t.type==="support.php_tag"&&e==="?>"&&!m?(o(),l=!0):f(t,"attribute-name")&&a.substr(-1).match(/^\s$/)?l=!0:f(t,"attribute-equals")?(w(),k()):f(t,"tag-close")&&(w(),e==="/>"&&(l=!0)),m&&!(t.type.match(/^(comment)$/)&&!e.substr(0,1).match(/^[/#]$/))&&!(t.type.match(/^(string)$/)&&!e.substr(0,1).match(/^['"]$/))){if(u=L,r>x)for(u++,n=r;n>x;n--)N[n]=u;else r<x&&(u=N[r]);for(x=r,L=u,v&&(u-=v),$&&!b&&(u++,$=!1),n=0;n<u;n++)a+=j}if(t.type==="keyword"&&e.match(/^(case|default)$/)&&(y[r]=e,r++),t.type==="keyword"&&e.match(/^(break)$/)&&y[r-1]&&y[r-1].match(/^(case|default)$/)&&r--,t.type==="paren.lparen"&&(b+=(e.match(/\(/g)||[]).length,S+=(e.match(/\{/g)||[]).length,r+=e.length),t.type==="keyword"&&e.match(/^(if|else|elseif|for|while)$/)?($=!0,b=0):!b&&e.trim()&&t.type!=="comment"&&($=!1),t.type==="paren.rparen")for(b-=(e.match(/\)/g)||[]).length,S-=(e.match(/\}/g)||[]).length,n=0;n<e.length;n++)r--,e.substr(n,1)==="}"&&y[r]==="case"&&r--;t.type=="text"&&(e=e.replace(/\s+$/," ")),l&&!m&&(w(),a.substr(-1)!==`
`&&(a+=" ")),a+=e,d&&(a+=" "),m=!1,l=!1,d=!1,(f(t,"tag-close")&&(h||D.indexOf(T)!==-1)||f(t,"doctype")&&e===">")&&(h&&s&&s.value==="</"?i=-1:i=1),f(t,"tag-open")&&e==="</"?r--:f(t,"tag-open")&&e==="<"&&q.indexOf(s.value)===-1?r++:f(t,"tag-name")?T=e:f(t,"tag-close")&&e==="/>"&&q.indexOf(T)===-1&&r--,R=B}}t=s}a=a.trim(),c.doc.setValue(a)},p.commands=[{name:"beautify",description:"Format selection (Beautify)",exec:function(c){p.beautify(c.session)},bindKey:"Ctrl-Shift-B"}]}),function(){ace.require(["ace/ext/beautify"],function(O){typeof module=="object"&&typeof exports=="object"&&module&&(module.exports=O)})}();
