ace.define("ace/ext/code_lens",["require","exports","module","ace/line_widgets","ace/lib/event","ace/lib/lang","ace/lib/dom","ace/editor","ace/config"],function(l,v,A){"use strict";var C=l("../line_widgets").LineWidgets,b=l("../lib/event"),_=l("../lib/lang"),m=l("../lib/dom");function W(e){var t=e.$textLayer,n=t.$lenses;n&&n.forEach(function(o){o.remove()}),t.$lenses=null}function y(e,t){var n=e&t.CHANGE_LINES||e&t.CHANGE_FULL||e&t.CHANGE_SCROLL||e&t.CHANGE_TEXT;if(!!n){var o=t.session,i=t.session.lineWidgets,d=t.$textLayer,a=d.$lenses;if(!i){a&&W(t);return}var f=t.$textLayer.$lines.cells,s=t.layerConfig,g=t.$padding;a||(a=d.$lenses=[]);for(var u=0,L=0;L<f.length;L++){var $=f[L].row,w=i[$],p=w&&w.lenses;if(!(!p||!p.length)){var c=a[u];c||(c=a[u]=m.buildDom(["div",{class:"ace_codeLens"}],t.container)),c.style.height=s.lineHeight+"px",u++;for(var r=0;r<p.length;r++){var h=c.childNodes[2*r];h||(r!=0&&c.appendChild(m.createTextNode("\xA0|\xA0")),h=m.buildDom(["a"],c)),h.textContent=p[r].title,h.lensCommand=p[r]}for(;c.childNodes.length>2*r-1;)c.lastChild.remove();var T=t.$cursorLayer.getPixelPosition({row:$,column:0},!0).top-s.lineHeight*w.rowsAbove-s.offset;c.style.top=T+"px";var x=t.gutterWidth,E=o.getLine($).search(/\S|$/);E==-1&&(E=0),x+=E*s.characterWidth,x-=t.scrollLeft,c.style.paddingLeft=g+x+"px"}}for(;u<a.length;)a.pop().remove()}}function H(e){if(!!e.lineWidgets){var t=e.widgetManager;e.lineWidgets.forEach(function(n){n&&n.lenses&&t.removeLineWidget(n)})}}v.setLenses=function(e,t){var n=Number.MAX_VALUE;H(e),t&&t.forEach(function(o){var i=o.start.row,d=o.start.column,a=e.lineWidgets&&e.lineWidgets[i];(!a||!a.lenses)&&(a=e.widgetManager.$registerLineWidget({rowCount:1,rowsAbove:1,row:i,column:d,lenses:[]})),a.lenses.push(o.command),i<n&&(n=i)}),e._emit("changeFold",{data:{start:{row:n}}})};function N(e){e.codeLensProviders=[],e.renderer.on("afterRender",y),e.$codeLensClickHandler||(e.$codeLensClickHandler=function(n){var o=n.target.lensCommand;o&&e.execCommand(o.id,o.arguments)},b.addListener(e.container,"click",e.$codeLensClickHandler,e)),e.$updateLenses=function(){var n=e.session;if(!n)return;n.widgetManager||(n.widgetManager=new C(n),n.widgetManager.attach(e));var o=e.codeLensProviders.length,i=[];e.codeLensProviders.forEach(function(a){a.provideCodeLenses(n,function(f,s){f||(s.forEach(function(g){i.push(g)}),o--,o==0&&d())})});function d(){var a=n.selection.cursor,f=n.documentToScreenRow(a);v.setLenses(n,i);var s=n.$undoManager&&n.$undoManager.$lastDelta;if(!(s&&s.action=="remove"&&s.lines.length>1)){var g=n.documentToScreenRow(a),u=e.renderer.layerConfig.lineHeight,L=n.getScrollTop()+(g-f)*u;n.setScrollTop(L)}}};var t=_.delayedCall(e.$updateLenses);e.$updateLensesOnInput=function(){t.delay(250)},e.on("input",e.$updateLensesOnInput)}function k(e){e.off("input",e.$updateLensesOnInput),e.renderer.off("afterRender",y),e.$codeLensClickHandler&&e.container.removeEventListener("click",e.$codeLensClickHandler)}v.registerCodeLensProvider=function(e,t){e.setOption("enableCodeLens",!0),e.codeLensProviders.push(t),e.$updateLensesOnInput()},v.clear=function(e){v.setLenses(e,null)};var M=l("../editor").Editor;l("../config").defineOptions(M.prototype,"editor",{enableCodeLens:{set:function(e){e?N(this):k(this)}}}),m.importCssString(".ace_codeLens {    position: absolute;    color: #aaa;    font-size: 88%;    background: inherit;    width: 100%;    display: flex;    align-items: flex-end;    pointer-events: none;}.ace_codeLens > a {    cursor: pointer;    pointer-events: auto;}.ace_codeLens > a:hover {    color: #0000ff;    text-decoration: underline;}.ace_dark > .ace_codeLens > a:hover {    color: #4e94ce;}","")}),function(){ace.require(["ace/ext/code_lens"],function(l){typeof module=="object"&&typeof exports=="object"&&module&&(module.exports=l)})}();
